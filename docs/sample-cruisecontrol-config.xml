<cruisecontrol>
    <project name="site.cloud_priv.sfr.com" buildafterfailed="false">

        <listeners>
            <currentbuildstatuslistener file="logs/${project.name}/status.txt"/>
        </listeners>

        <bootstrappers>
            <!-- <antbootstrapper anthome="apache-ant-1.7.0" buildfile="projects/${project.name}/build.xml" target="clean" /> -->
        </bootstrappers>

        <modificationset quietperiod="30">
            <!-- touch any file in connectfour project to trigger a build -->
            <!-- <filesystem folder="projects/${project.name}"/> -->
            <!-- <alwaysbuild/> -->
            <mercurial localWorkingCopy="projects/${project.name}/src" />
        </modificationset>

        <schedule interval="180">
            <phing phingscript="phing"
                phingWorkingDir="projects/${project.name}/"
                buildfile="build.xml" uselogger="true" usedebug="false"/>
        </schedule>

        <log dir="logs/${project.name}">
            <merge dir="projects/${project.name}/build/logs/"/>
        </log>

        <publishers>
            <onsuccess>
                <artifactspublisher dest="artifacts/${project.name}"
                    dir="projects/${project.name}/build/docs/"
                    subdirectory="api"/>
                <artifactspublisher dest="artifacts/${project.name}"
                    dir="projects/${project.name}/build/coverage/"
                    subdirectory="coverage"/>
                <artifactspublisher dest="artifacts/${project.name}"
                    dir="projects/${project.name}/build/browser/"
                    subdirectory="php-code-browser"/>
                <artifactspublisher dest="artifacts/${project.name}"
                    dir="projects/${project.name}/build/graph/"
                    subdirectory="graph"/>
                <execute command="phpuc graph logs/${project.name} artifacts/${project.name}" />
            </onsuccess>
        </publishers>

    </project>
</cruisecontrol>
